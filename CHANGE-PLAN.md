# CHANGE-PLAN.md

## Поэтапный план внедрения дополнительных функций

### Этап 1. Анализ и подготовка
1. Проверить актуальные поля в `prisma/schema.prisma` (`isPublic`, `visibility`, связи лайков).
2. Уточнить структуру сессии и пользователя (Auth) для определения `likedByMe`.
3. Сверить существующие компоненты и layout, чтобы не дублировать функционал.

### Этап 2. Общий layout
1. Добавить `Header` и `Footer` в `app/layout.tsx`.
2. Создать базовые компоненты в `components/layout/` и подключить навигацию.

### Этап 3. Главная страница (Server Component)
1. Реализовать `app/page.tsx` как серверный компонент.
2. Получить `session` и подготовить данные для двух секций.
3. Добавить hero-блок с кнопкой “Добавить промт” и логикой для гостя.

### Этап 4. Данные и Prisma-запросы
1. Реализовать `recentPrompts` с сортировкой по `createdAt` desc.
2. Реализовать `popularPrompts` с сортировкой по количеству лайков desc.
3. Добавить получение `_count.likes` и вычисление `likedByMe` через `Set`.

### Этап 5. UI-компоненты промтов
1. Создать `PromptCard` с заголовком, автором, датой, тегами и кнопкой “Открыть”.
2. Добавить `LikeButton` как client component и подключить состояние лайка.
3. Исключить кнопки редактирования/удаления на главной.

### Этап 6. Права доступа
1. Проверить, что CRUD и смена public/private доступны только авторизованным.
2. Добавить guards на страницы редактирования (redirect на login или 403).

### Этап 7. Адаптивность и полировка
1. Проверить отображение на мобильных и планшетах.
2. Добавить `Skeleton` при необходимости для загрузки.

### Этап 8. Проверка и отчёт
1. Тесты вручную: создание промта, отображение в “Новые/Популярные”, лайки.
2. Проверить отсутствие редактирования на публичных страницах.
3. Подготовить отчёт: список файлов, ключевые фрагменты, шаги проверки.
